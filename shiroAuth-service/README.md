参照这个实现
https://www.cnblogs.com/ll409546297/p/7815409.html